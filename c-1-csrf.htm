<!-- 
===========================================================
ЁЯЯж 1) CSRF ржЖрж╕рж▓рзЗ ржХрзА? (рж╢рзБрж░рзБржЯрж╛)
===========================================================

CSRF рж╣рж▓рзЛ ржПржоржи ржПржХржЯрж┐ ржЖржХрзНрж░ржоржг ржпрзЗржЦрж╛ржирзЗ тАФ

ЁЯСЙ ржЖржкржирж┐ рж▓ржЧржЗржи ржерж╛ржХрж╛ ржЕржмрж╕рзНржерж╛ржпрж╝  
ЁЯСЙ ржХрзЛржирзЛ рж╣рзНржпрж╛ржХрж╛рж░ ржЖржкржирж╛ржХрзЗ ржлрж╛ржБржХрж┐ ржжрж┐рзЯрзЗ  
ЁЯСЙ ржЖржкржирж╛рж░ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржжрж┐ржпрж╝рзЗ ржЖржкржирж╛рж░ ржирж╛ржорзЗ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржкрж╛ржарж┐ржпрж╝рзЗ ржжрзЗржпрж╝  

тЮб ржЖржкржирж┐ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржкрж╛ржарж╛ржиржирж┐,  
   ржХрж┐ржирзНрждрзБ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржХрзБржХрж┐/рж╕рзЗрж╢ржи ржкрж╛ржарж┐рзЯрзЗ ржжрзЗржпрж╝ ржмрж▓рзЗ 
   рж╕рж╛рж░рзНржнрж╛рж░ ржоржирзЗ ржХрж░рзЗ "ржЗржЙржЬрж╛рж░ржЗ ржкрж╛ржарж╛ржЪрзНржЫрзЗ"ред

===========================================================
ЁЯЯж 2) ржмрж╛рж╕рзНрждржм ржЬрзАржмржирзЗрж░ ржЦрзБржм рж╕рж╣ржЬ ржЙржжрж╛рж╣рж░ржг
===========================================================

ржзрж░рзЛ рждрзБржорж┐ ржПржХржЯрж┐ рж╕рж╛ржЗржЯрзЗ рж▓ржЧржЗржи ржХрж░рзЗ ржЖржЫрзЛ:
mybank.com

ржПржЦржи рждрзБржорж┐ ржнрзБрж▓ ржХрж░рзЗ ржЧрзЗрж▓рзЗ ржПржХ ржорзНржпрж╛рж▓рж┐рж╢рж┐ржпрж╝рж╛рж╕ рж╕рж╛ржЗржЯрзЗ:
evil.com

рж╕рзЗржЦрж╛ржирзЗ ржПржХржЯрж┐ рж▓рзБржХрж╛ржирзЛ ржлрж░рзНржо ржЖржЫрзЗ:

<form action="https://mybank.com/send-money" method="POST">
  <input type="hidden" name="amount" value="5000">
  <input type="hidden" name="to" value="hacker">
</form>

<script>
  document.forms[0].submit();
</script>

тЮб рждрзБржорж┐ ржкрзЗржЬ ржЦрзБрж▓рждрзЗржЗ ржмрзНрж░рж╛ржЙржЬрж╛рж░ рждрзЛржорж╛рж░ рж▓ржЧржЗржи ржХрзБржХрж┐ ржкрж╛ржарж┐рзЯрзЗ ржжрж┐рж▓  
тЮб ржЯрж╛ржХрж╛ ржкрж╛ржарж┐рзЯрзЗ ржжрзЗржУрзЯрж╛ рж╣рж▓рзЛ  
тЮб ржЕржержЪ рждрзБржорж┐ ржХрж┐ржЫрзБржЗ ржХрж░рзЛржирж┐  

ржПржЯрж╛ржЗ CSRF Attackред

===========================================================
ЁЯЯж 3) ржХрзЗржи CSRF рж╣рзЯ?
===========================================================

ржХрж╛рж░ржг тАФ

тЬФ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржЕржЯрзЛржорзЗржЯрж┐ржХ ржХрзБржХрж┐ ржкрж╛ржарж╛рзЯ  
тЬФ рж╕рж╛рж░рзНржнрж╛рж░ ржмрзБржЭрждрзЗ ржкрж╛рж░рзЗ ржирж╛ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ "ржЗржЙржЬрж╛рж░" ржкрж╛ржарж┐рзЯрзЗржЫрзЗ ржирж╛ржХрж┐ "рж╣рзНржпрж╛ржХрж╛рж░"  
тЬФ рж╣рзНржпрж╛ржХрж╛рж░ рж▓рзБржХрж╛ржирзЛ form / image / script ржжрж┐рзЯрзЗ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржЯрзНрж░рж┐ржЧрж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗ  

===========================================================
ЁЯЯж 4) ржХрж┐ржнрж╛ржмрзЗ ржмрж╛ржБржЪрж╛ ржпрж╛рзЯ? (ржПржЯрж╛ржЗ ржЖрж╕рж▓ рж╢рзЗржЦрж╛рж░ ржЕржВрж╢)
===========================================================

-----------------------------------------------------------
тЬФя╕П (рзз) CSRF Token ржмрзНржпржмрж╣рж╛рж░
-----------------------------------------------------------

рж╕ржмржЪрзЗрзЯрзЗ ржЬржиржкрзНрж░рж┐рзЯ рж╕ржорж╛ржзрж╛ржи тАФ  
рж╕рж╛рж░рзНржнрж╛рж░ ржкрзНрж░рждрж┐ржЯрж┐ ржлрж░рзНржорзЗрж░ рж╕рж╛ржерзЗ ржПржХржЯрж┐ ржЧрзЛржкржи ржЯрзЛржХрзЗржи ржкрж╛ржарж╛рзЯред

рж╕рж╛рж░рзНржнрж╛рж░:
const csrfToken = "random-secret-123";

res.send(`
  <form action="/update" method="POST">
    <input type="hidden" name="csrf" value="${csrfToken}" />
    <button type="submit">Update</button>
  </form>
`);

ржлрж░рзНржо рж╕рж╛ржмржорж┐ржЯ рж╣рж▓рзЗ рж╕рж╛рж░рзНржнрж╛рж░ ржЯрзЛржХрзЗржи ржЪрзЗржХ ржХрж░рзЗ:
if (req.body.csrf !== "random-secret-123") {
  return res.status(403).send("CSRF Attack detected!");
}

тЮб ржнрзБрзЯрж╛ рж╕рж╛ржЗржЯрзЗ ржПржЗ ржЯрзЛржХрзЗржи ржерж╛ржХржмрзЗ ржирж╛,  
   рждрж╛ржЗ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржмрзНржпрж░рзНрже рж╣ржмрзЗред

-----------------------------------------------------------
тЬФя╕П (рзи) SameSite Cookie ржмрзНржпржмрж╣рж╛рж░
-----------------------------------------------------------

ржПржЯрж┐ ржЖржзрзБржирж┐ржХ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ рж╕ржмржЪрзЗрзЯрзЗ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржкрзНрж░рзЛржЯрзЗржХрж╢ржиред

Set-Cookie: session=abc123; SameSite=Lax; Secure;

SameSite=Lax тЯ╢ ржЕржирзНржп рж╕рж╛ржЗржЯ ржерзЗржХрзЗ ржЖрж╕рж▓рзЗ ржХрзБржХрж┐ ржкрж╛ржарж╛ржирзЛ ржпрж╛ржмрзЗ ржирж╛ред  
ржлрж▓рзЗ CSRF ржХрж░рж╛ ржкрзНрж░рж╛рзЯ ржЕрж╕ржорзНржнржм рж╣рзЯрзЗ ржпрж╛рзЯред

-----------------------------------------------------------
тЬФя╕П (рзй) Origin / Referer Header ржЪрзЗржХ
-----------------------------------------------------------

рж╕рж╛рж░рзНржнрж╛рж░ ржжрзЗржЦрзЗ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржПрж╕рзЗржЫрзЗ ржХрж┐ ржЖрж╕рж▓ рж╕рж╛ржЗржЯ ржерзЗржХрзЗ?

if (req.headers.origin !== "https://mybank.com") {
  return res.status(403).send("Blocked! Suspicious Request");
}

-----------------------------------------------------------
тЬФя╕П (рзк) Double Submit Cookie Pattern
-----------------------------------------------------------

ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ рж╕рж╛ржЗржб ржУ рж╕рж╛рж░рзНржнрж╛рж░ рж╕рж╛ржЗржб ржПржХржЗ ржЯрзЛржХрзЗржи ржкрж╛ржарж╛рзЯ  
ржПржмржВ рж╕рж╛рж░рзНржнрж╛рж░ ржорж┐рж▓рж┐рзЯрзЗ ржжрзЗржЦрзЗ ржЯрзЛржХрзЗржи рж╕ржарж┐ржХ ржХрж┐ржирж╛ред

===========================================================
ЁЯЯж 5) CSRF ржмрзЛржЭрж╛рж░ рж╕рж╣ржЬ рж▓рж╛ржЗржи (рж╕рж╛рж░рж╛ржВрж╢)
===========================================================

CSRF = рж╣рзНржпрж╛ржХрж╛рж░ ржЖржкржирж╛ржХрзЗ ржирж╛ ржЬрж╛ржирж┐ржпрж╝рзЗ  
        ржЖржкржирж╛рж░ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржжрж┐ржпрж╝рзЗ  
        ржЖржкржирж╛рж░ ржирж╛ржорзЗ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржкрж╛ржарж╛ржпрж╝ред

===========================================================
-->
